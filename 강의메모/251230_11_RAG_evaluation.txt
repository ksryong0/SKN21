Naive Rag?
질문-검색 + 질문 -> 체인에 넣음 ??

질문에 대한 임베딩 벡터로 유사도 검색이 잘 안되더라
1. ?
2. 검색하기 전에 질문을 변경해봄. 멀티쿼리 리트리버, 셀프쿼리 리트리버가 이 역할.
질문을 바꿔봄
+필터링도 가능.

검색 결과가 마음에 안 들 때?
Rerank. 검색되서 나온 결과물들을 정제화해줌. 그걸 다시 LLM 체인에 넣음.
초기검색단계에서 추출된 후보 문서들의 순위를 재조정.

그래도 결과가 별로면 모델이 문제일 수도 있음.
아니면 잘못된 모델을 사용했거나?

api를 쓴다는건 LLM모델한테 쿼리를 보내서 결과를 받겠다.
chat-gpt를 쓰냐 api를 쓰냐는, 구조화된 걸 쓰냐 안쓰냐의 차이.

프롬프트로 LLM의 knowledge cutoff를 메꿀 수 있다. 그런 방법중에 하나가 RAG
------------
RAG 평가 개요

검색 단계 평가:문서는 잘 검색된건지

평가 지표

생성쪽 : answer

답변이 질문에 관련된 답변이냐? Answer relevancy

우리가 보내준 문서 안에서 답을 찾아서 주는게 RAG의 목적. 답변이 Context에서 추론할 수 있는건지. 
답변이 Context에 있는 내용인지? Faithfulness

Context가 유저 질문과 관련된 내용인지? Context Precision

Context가 정답하고 관련이 있는지? Context Recall

계산방법은 기억이 안날수도 있음.
평가 지표들을 왜 보는지. 어떤 의미인지. 어떻게 해석해야 하는지. 모델을 어떻게 개선시킬 수 있는지.

도커->컨테이너->qdrant

똑같은 프롬프트를 여러번 써도 됨.

합성 데이터셋 : 모델->데이터셋. 딥러닝 모델이 만들어준 데이터셋.

함수 A와 함수 B가 있으면
함수 A			함수 B

동기적 방식:함수 A가 끝나면 함수 B가 동작하기 시작. 함수 A와 B는 연관성은 없음. 쉬는 시간에는 기다려야 함.
비동기적 방식:함수 A하고 B하고 C하고 같이 실행시킴. 쉬는 시간이 없음. I/O. 크롤링에서 많이 사용.
너무 빨리 바뀌면 DDos하는줄 알고 IP가 막힐수도 있음. 그런게 없으면 비동기가 훨씬 빠름.

------------
12_Agent_ToolCalling

LLM-지식제공자

agent는 내가 다음 일은 뭐해야돼? 라고 물어보면 LLM이 답변해주는 거.
LLM을 사람의 뇌처럼 씀.

LLM을 일의 흐름을 판단하는 역할, 뇌의 역할.
사람이 살아있는데 뇌밖에 없으면, 생각밖에 못함. 듣지도 못하고 말도 못함.

사람
뇌
손 발 내장기관

LLM->일의 흐름을 판단->뇌의 역할
tool tool tool

툴을 사용할 수 있는 LLM이 필요.

툴: 함수.
툴을 하나만 쓸수있고, 여러개를 쓸수도 있고.

Agent-대리인. 사람이 할일을 대신 해 줌. 

S/W적인 도구들.
S/W가 장치하고 연결되어있을수도 있음.
그럼 S/W한테 일시키면 장치가 동작함.

Workflow - LCEL. 어떻게 일해야하는지 정해서 순서대로 나열한 것.
Agent - LLM이 뭐하고 뭐할지를 판단. 정해진 순서대로 일하지 않음. 분기에 대한 흐름은 만들어줘야함. 사람의 개입을 최소화함. 하지만 사람이 아예 개입을 안할수는 없음. 

특징
자율성
목표 지향성-최종결과가 완벽히 나올때까지 일을 함. 하는일이 최종목표 달성에 도움이 되는가.
도구활용. LLM만으로는 이게 안됨. 생각을 못함. 자료들이 필요. 자료들을 가져올수 있는 도구가 필요
인간 개입(human in the loop) 최소화

ReAct(Reasoning Acting)
생각-행동-관찰 반복. 관찰했을 때 이정도면 원하는 결과가 나왔어 할 때까지.

어떤 툴을 어떻게 사용할지? LLM은 이런 판단을 잘하는 LLM을 쓰면 됨.

툴?
하나의 기능을 처리하는 함수. LLM이 툴을 사용하는 걸 Toolcalling 이라고 함.
Toolcalling:Agent의 시작.

Tool-기능. 함수. LLM의 손발이 되어 작업을 수행해주는 애들.
함수의 이름이 툴의 이름임.
툴에 대한 설명서
어떤 파라미터를 넣어서 쓰는지 알러줘.
도구 사용여부를 판단.

이 툴을 호출해야 되요 라고 알려쥠. 그러면 어떻게 호출해야 하는지 요청보내줌.

툴 콜링을 지원하는 모델을 사용해야함.

빌트인 툴:미리 만들어둔 툴
MCP도 하나의 툴임.





